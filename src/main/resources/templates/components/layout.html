<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<body>

<!-- ################# -->
<!-- Header            -->
<!-- ################# -->
<div th:fragment="head" th:remove="tag">
    <meta charset="utf-8"/>

    <link href="/manifest.json" rel="manifest" th:if="${toggles.pwa}"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <link rel="apple-touch-icon" th:href="${page.assetUrl} + '/assets/wutsi/img/logo/logo_96x96.png'"/>
    <meta content="#f8f8f8" name="theme-color">
    <meta content="#f8f8f8" name="apple-mobile-web-app-status-bar"/>
    <meta content="yes" name="apple-mobile-web-app-capable"/>
    <meta content="Wutsi" name="apple-mobile-web-app-title"/>
    <meta content="yes" name="mobile-web-app-capable"/>

    <meta name="wutsi:page_name" th:content="${page.name}"/>
    <meta name="wutsi:story_id" th:content="${story.id}" th:if="${story}"/>
    <meta name="wutsi:hit_id" th:content="${hitId}" th:if="${hitId}"/>

    <title th:if="${page.title} == 'Wutsi'" th:text="${page.title}"></title>
    <title th:if="${page.title} != 'Wutsi'" th:text="${page.title} + ' | Wutsi'"></title>

    <meta name="description" th:content="${page.description}"/>

    <meta property="og:site_name" th:content="Wutsi"/>
    <meta property="og:type" th:content="${page.type}"/>
    <meta property="og:url" th:content="${page.url}"/>
    <meta property="og:title" th:content="${page.title}"/>
    <meta property="og:description" th:content="${page.description}"/>
    <meta property="og:image" th:content="${page.imageUrl}" th:if="${page.imageUrl}"/>
    <meta property="article:author" th:content="${page.author}" th:if="${page.author}"/>
    <meta property="article:published_time" th:content="${page.publishedTime}" th:if="${page.publishedTime}"/>
    <meta property="article:modified_time" th:content="${page.modifiedTime}" th:if="${page.modifiedTime}"/>
    <meta property="article:tag" th:content="${tag}" th:each="tag : ${page.tags}"/>

    <meta name="twitter:card" th:content="${page.imageUrl} ? 'summary_large_image' : 'summary'"/>
    <meta name="twitter:site" th:content="'@' + ${page.twitterUserId}" th:if="${page.twitterUserId}"/>
    <meta name="twitter:creator" th:content="'@' + ${page.twitterUserId}" th:if="${page.twitterUserId}"/>
    <meta name="twitter:title" th:content="${page.title}"/>
    <meta name="twitter:description" th:content="${page.description}"/>
    <meta name="twitter:image" th:content="${page.imageUrl}" th:if="${page.imageUrl}"/>

    <meta name="facebook:app_id" th:content="${page.facebookAppId}"/>

    <meta name="_csrf" th:content="${_csrf.token}" th:if="${_csrf}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}" th:if="${_csrf}"/>

    <meta name="robots" th:content="${page.robots}"/>

    <link rel="canonical" th:href="${page.canonicalUrl}" th:if="${page.canonicalUrl}"/>

    <link rel="shortcut icon" th:href="${page.assetUrl} + '/assets/wutsi/img/favicon.ico'"/>

    <!-- BEGIN: GOOGLE FONTS -->
    <!--
    <script type="text/css">
        @font-face{font-family:Lora;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/lora/v17/0QI6MX1D_JOuGQbT0gvTJPa787weuxJMkqt8ndeYxZ2JTg.woff) format('woff');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:Lora;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/lora/v17/0QI6MX1D_JOuGQbT0gvTJPa787weuxJFkqt8ndeYxZ2JTg.woff) format('woff');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:Lora;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/lora/v17/0QI6MX1D_JOuGQbT0gvTJPa787weuxJOkqt8ndeYxZ2JTg.woff) format('woff');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:Lora;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/lora/v17/0QI6MX1D_JOuGQbT0gvTJPa787weuxJPkqt8ndeYxZ2JTg.woff) format('woff');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Lora;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/lora/v17/0QI6MX1D_JOuGQbT0gvTJPa787weuxJBkqt8ndeYxZ0.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v12/jizaRExUiTo99u79D0-ExcOPIDUg-g.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v12/jizaRExUiTo99u79D0aExcOPIDUg-g.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v12/jizaRExUiTo99u79D0yExcOPIDUg-g.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'PT Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ptsans/v12/jizaRExUiTo99u79D0KExcOPIDU.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}
    </script>
    -->
    <!-- END: GOOGLE FONTS -->

    <link th:href="${page.assetUrl} + '/assets/wutsi/css/preload-2.css'" rel="stylesheet">
    <link as="style" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" onload="this.onload=null;this.rel='stylesheet'" rel="preload"/>
    <link as="style" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" onload="this.onload=null;this.rel='stylesheet'" rel="preload"/>
    <link as="style" th:href="${page.assetUrl} + '/assets/wutsi/css/main-120.css'" onload="this.onload=null;this.rel='stylesheet'" rel="preload"/>
    <noscript>
        <link href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" rel="stylesheet">
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" th:href="${page.assetUrl} + '/assets/wutsi/css/main-120.css'"/>
    </noscript>

    <link rel="alternate" th:href="${page.rssUrl}" th:if="${page.rssUrl}" type="application/rss+xml"/>
    <link href="/sitemap.xml" rel="sitemap" title="Sitemap" type="application/xml"/>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <script th:src="${page.assetUrl} + '/assets/wutsi/js/wutsi-28.js'"></script>

    <script th:if="${page.schemas}" th:utext="${page.schemas}" type="application/ld+json"></script>
</div>


<!-- ################# -->
<!-- Footer            -->
<!-- ################# -->
<footer class="page-footer container-fluid padding-2x margin-top-4x border-top d-none d-md-block" th:fragment="footer">
    <div class="container">
        <div class="row">
            <div class="col-12 col-md-9 margin-bottom">
                &copy; Wutsi.
                <br/>
                <a class="text-small" href="/" th:text="#{label.home}">Home</a>
                |
                <a class="text-small" href="/about" th:text="#{label.about}">About</a>
                |
                <a class="text-small" href="/create" th:text="#{label.create_blog}">Create Blog</a>
                |
                <a class="text-small" href="/partner" th:if="${toggles.wpp}">Wutsi Partner Program</a>
                |
                <a class="text-small" href="/terms" th:text="#{label.terms_conditions}">Terms and Condition</a>
                |
                <a class="text-small" href="/privacy" th:text="#{label.privacy}">Privacy</a>
            </div>
            <div class="col-12 col-md-3 text-right follow-us">
                <a href="https://www.facebook.com/2502022716689613" target="_new">
                    <i class="fab fa-facebook"></i>
                </a>
                <a href="https://www.twitter.com/wutsi2" target="_new">
                    <i class="fab fa-twitter"></i>
                </a>
                <a href="https://www.linkedin.com/company/wutsi-inc" target="_new">
                    <i class="fab fa-linkedin"></i>
                </a>
            </div>
        </div>
    </div>

    <div th:replace="components/google :: analytics"></div>
    <div th:replace="components/google :: firebase"></div>

    <div th:replace="components/facebook :: pixel"></div>

    <script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>
    <script>
        $(document).ready(function () {
            wutsi.domReady();
        });
    </script>

    <script th:if="${toggles.pwaPushNotification}" th:inline="javascript">
        /*<![CDATA[*/
        function pwa_notification_init() {
            const showNotificationOptIn = /*[[${page.showNotificationOptIn}]]*/'false';
            const firebaseVapidKey = /*[[${page.firebaseConfig.publicVapidKey}]]*/'';
            const firebaseConfig = {
                apiKey: /*[[${page.firebaseConfig.apiKey}]]*/ '',
                projectId: /*[[${page.firebaseConfig.projectId}]]*/ '',
                messagingSenderId: /*[[${page.firebaseConfig.senderId}]]*/ '',
                appId: /*[[${page.firebaseConfig.appId}]]*/ ''
            };
            firebase_setup(reg, firebaseConfig, firebaseVapidKey, showNotificationOptIn)
        }

        /*]]>*/
    </script>
    <script th:if="!${toggles.pwaPushNotification}">
        function pwa_notification_init() {
        }
    </script>

    <script id="pwa-js" th:if="${toggles.pwa}" th:inline="javascript">
        /*<![CDATA[*/

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker
                .register('/sw.js')
                .then(function (reg) {
                    console.log('Service Worker registered', reg);

                    // Upgrade
                    reg.addEventListener('updatefound', function () {
                        console.log('Upgrading Service Worker...');

                        const newWorker = reg.installing;
                        newWorker.addEventListener('statechange', function () {
                            // Has service worker state changed?
                            switch (newWorker.state) {
                                case 'installed':
                                    reg.update();
                                    console.log('Service Worker updated');
                                    break;
                            }
                        });
                    });

                    // Push Notification
                    pwa_notification_init();
                })
                .catch(function (err) {
                    console.error('service worker not registered', err);
                });
        }

        /*]]>*/
    </script>

    <script id="a2hs-js" src="/a2hs.js" th:if="${toggles.pwa} AND ${toggles.pwaAddToHomescreen}"></script>
</footer>


<!-- ################# -->
<!-- Navbar            -->
<!-- ################# -->
<div th:fragment="navbar">
    <nav class="navbar navbar-expand navbar-light border-bottom fixed-top navbar-site"
         th:classappend="${superUser} ? super-user"
    >
        <a class="navbar-brand" href="/">
            <img alt="Wutsi" th:src="${page.assetUrl} + '/assets/wutsi/img/logo/name-104x50.png'" title="Wutsi"/></a>


        <ul class="navbar-nav ml-auto" th:if="${page.name != 'page.login'}">
            <li th:replace="components/layout :: navbar-dropdown"></li>

            <li class="nav-item d-none d-lg-block" th:if="!${user} AND ${page.name != 'page.welcome'}">
                <a class="btn btn-primary" href="/create" id="navbar-create" th:text="#{button.create_blog}">Create your Blog</a>
            </li>
            <li class="nav-item d-none d-lg-block" th:if="!${user} AND ${page.name != 'page.login'} AND ${page.name != 'page.welcome'}">
                <a class="btn btn-light" href="/login" id="navbar-login" rel="nofollow" th:text="#{button.login}">Login</a>
            </li>
        </ul>
    </nav>
    <div class="navbar-margin">&nbsp;</div>
</div>

<!-- ################# -->
<!-- Blog Navbar       -->
<!-- ################# -->
<div th:fragment="navbar-blog(blog, showFollowButton, returnUrl)">
    <nav class="navbar navbar-expand navbar-light border-bottom fixed-top navbar-blog"
         th:classappend="${superUser} ? super-user"
    >
        <a class="navbar-brand" th:href="${blog.slug}">
            <img class="blog-logo" th:alt="${blog.fullName}" th:if="${blog.pictureUrl}" th:src="${blog.pictureSmallUrl}" th:title="${blog.fullName}"/>
            <span class="blog-name" th:text="${blog.fullName}">Title</span>
        </a>

        <ul class="navbar-nav ml-auto">
            <li class="nav-item d-none d-lg-block" th:if="!${user} AND ${page.name != 'page.login'}">
                <a class="btn btn-light" href="/login" id="navbar-login" rel="nofollow" th:text="#{button.login}">Login</a>
            </li>
            <li class="nav-item" th:if="${toggles.follow} AND ${showFollowButton} AND ${page.name != 'page.login'}">
                <div th:replace="components/follow :: follow-button(${blog}, ${returnUrl}, true, false)"></div>
            </li>
            <li th:replace="components/layout :: navbar-dropdown"></li>
        </ul>
    </nav>
    <div class="navbar-margin">&nbsp;</div>
</div>

<li class="nav-item dropdown" th:fragment="navbar-dropdown" th:if="${user}">
    <a aria-expanded="false" aria-haspopup="true" class="nav-link user btn btn-light" data-toggle="dropdown" href="#" id="navbarDropdown" role="button">
        <i class="fas fa-caret-down"></i>
    </a>

    <div aria-labelledby="navbarDropdown" class="dropdown-menu">
        <div class="dropdown-item-user flex">
            <a th:href="${user.slug}" th:title="${user.fullName}">
                <img th:if="${user.pictureUrl}" th:src="${user.pictureSmallUrl}" th:title="${user.fullName}"/>
                <div class="user-info">
                    <b th:text="${user.fullName}">Herve Tchepannou</b>
                    <br/>
                    @<span th:text="${user.name}"></span>
                </div>
            </a>
        </div>
        <div class="dropdown-divider"></div>

        <a class="dropdown-item" href="/create" id="navbar-create-blog" rel="nofollow" th:if="!${user.blog}" th:text="#{navbar.create-blog}">Start
            Writing</a>
        <a class="dropdown-item" href="/me/draft" id="navbar-draft" rel="nofollow" th:if="${user.blog}" th:text="#{navbar.my-stories}">My Stories</a>
        <a class="dropdown-item" href="/editor" id="navbar-editor" rel="nofollow" th:if="${user.blog}" th:text="#{navbar.new-stories}">New Story</a>
        <a class="dropdown-item" href="/me/syndicate" id="navbar-syndicate" rel="nofollow" th:if="${user.blog}" th:text="#{navbar.syndicate-story}">Import
            Story</a>
        <a class="dropdown-item" href="/me/calendar" id="navbar-calendar" rel="nofollow" th:if="${user.blog} AND ${toggles.post}"
           th:text="#{navbar.calendar}">Calendar</a>

        <div class="dropdown-divider" th:if="${user.blog}"></div>
        <a class="dropdown-item" href="/stats" id="navbar-stats" rel="nofollow" th:if="${user.blog}" th:text="#{navbar.stats}">Stats</a>
        <a class="dropdown-item" href="/partner" id="navbar-wpp" th:if="${toggles.wpp} AND ${user.blog}" th:text="#{navbar.wpp}">Wutsi Partner Program</a>
        <a class="dropdown-item" href="/me/earning" id="navbar-earnings" th:if="${toggles.earning} AND ${user.blog}"
           th:text="#{navbar.earnings}">Earnings</a>

        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="/me/settings" id="navbar-settings" rel="nofollow" th:text="#{navbar.settings}">Settings</a>

        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="/login/as" id="navbar-runas" rel="nofollow" th:if="${superUser}">Run As</a>
        <a class="dropdown-item" href="/logout" id="navbar-logout" rel="nofollow" th:text="#{navbar.logout}">Logout</a>
    </div>
</li>

<div th:fragment="navbar-super-user-banner">
    <div class="text-center" id="super-user-banner" th:if="${superUser}">
        <b>SUPER USER MODE</b>
        <div>With Great Power comes Great Responsabilities</div>
    </div>
    <div/>


    <div id="next-action-container" th:fragment="next-action(userId)">
        <script th:inline="javascript">
            /*<![CDATA[*/

            $(document).ready(function () {
                $('#next-action-container').load('/next-action?id=' + /*[[${userId}]]*/'');
            });

            /*]]>*/
        </script>
    </div>
</div>

</body>
</html>
