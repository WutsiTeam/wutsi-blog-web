<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<body>

<div  th:fragment="toolbar">
    <a id="toolbar-syndicate" class="btn btn-light float-right" href="/me/syndicate" th:text="#{button.syndicate_story}">Syndicate Story</a>
    <a id="toolbar-create" class="btn btn-primary margin-right float-right" href="/editor" th:text="#{button.create_story}">New Story</a>
    <div class="clearfix"></div>
</div>

<ul th:fragment="tabs(status, totalDraftStories, totalPublishedStories)" class="nav nav-tabs">
    <li class="nav-item">
        <a id="tab-draft" class="nav-link" href="/me/draft"  th:classappend="${status} == 'draft' ? 'active' : null">
            <span th:text="#{story.status.draft}">Draft</span>
            <span class="badge badge-light" th:text="${totalDraftStories}" th:if="${totalDraftStories} GT 0">9</span>
        </a>
    </li>
    <li class="nav-item">
        <a id="tab-published" class="nav-link" href="/me/story/published" th:classappend="${status} == 'published' ? 'active' : null">
            <span th:text="#{story.status.published}">Published</span>
            <span class="badge badge-light" th:text="${totalPublishedStories}" th:if="${totalPublishedStories} GT 0">9</span>
        </a>
    </li>
</ul>

<div th:fragment="listitem(story)" class="story col-12" th:id="'story-' + ${story.id}">

    <a th:href="${story.draft} ? '/editor/' + ${story.id} : ${story.slug}">
        <h3 class="title" th:text="${story.title}">Title</h3>
        <h3 class="disabled" th:text="#{story.no_title}" th:if="${story.title.isEmpty()}">Title</h3>

        <div class="summary" th:text="${story.summary}">Summary</div>
        <div class="disabled" th:text="#{story.no_summary}" th:if="${story.summary.isEmpty()}">Summary</div>
    </a>

    <div class="meta">
        <span th:text="#{label.modified}">Last Modified:</span> <span th:text="${story.modificationDateTime}">2 days ago</span>
        -
        <span th:text="#{story.read_time(${story.readingMinutes})}" th:if="${story.readingMinutes} GT 0">6 min</span>
        (<span th:text="#{story.word_count(${story.wordCount})}">250 mots</span>)

        <div class="dropdown show story-dropdown-menu margin-left">
            <a class="btn btn-light btn-sm" href="#" role="button" th:id="'story-menu-' + ${story.id}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="fas fa-ellipsis-h"></i>
            </a>

            <div th:id="'story-menu' + ${story.id}" class="dropdown-menu" th:aria-labelledby="'story-menu' + ${story.id}">
                <a class="dropdown-item menu-item-edit" th:href="'/editor/' + ${story.id}" th:text="#{button.edit}">Edit</a>
                <a class="dropdown-item menu-item-preview" target="_new" th:href="'/read/' + ${story.id} + '?preview=true'" th:text="#{button.preview}" th:if="${story.draft}">Preview</a>
                <a class="dropdown-item menu-item-publish"
                   th:href="'/me/story/' + ${story.id} + '/publish'"
                   th:text="#{button.publish}"
                   th:if="${story.draft} AND ${toggles.publish}"
                >Publish</a>
            </div>
        </div>
    </div>

</div>

<div th:fragment="share(story)" class="share">

    <button class="btn btn-primary btn-block hidden">
        <i class="fas fa-share-alt"></i>
        <span th:text="#{button.share}">Share</span>
    </button>

    <div class="fallback hidden text-right">
        <a target="_blank" class="margin-top share-twitter btn-share"
           wutsi-track-event="share"
           wutsi-track-value="twitter"
           th:href="'http://www.twitter.com/intent/tweet?url=' + ${page.url}">
            <i class="fab fa-twitter-square"></i>
        </a>
        <a target="_blank" class="margin-top-2x share-facebook btn-share"
           wutsi-track-event="share"
           wutsi-track-value="facebook"
           th:href="'https://www.facebook.com/sharer/sharer.php?display=page&u=' + ${page.url}">
            <i class="fab fa-facebook-square"></i>
        </a>
        <a target="_blank" class="margin-top share-linkedin btn-share"
           wutsi-track-event="share"
           wutsi-track-value="linkedin"
           th:href="'https://www.linkedin.com/shareArticle?mini=true&url=' + ${page.url}">
            <i class="fab fa-linkedin"></i>
        </a>
    </div>

    <script>
        $(document).ready(function(){
            if (navigator.share){
                $('.share button').removeClass('hidden');
            } else {
                $('.share .fallback').removeClass('hidden');
            }

            $('.share button').click(function(){
                const request = {
                    title: $("meta[property=og\\:title]").attr("content"),
                    url: $("meta[property=og\\:url]").attr("content")
                };

                console.log('Shading ', request);
                navigator.share(request).then(function(event){
                    console.log('Share succeed', event);
                    wutsi.track('share');
                }).catch(function(error){
                    console.error('Share failed', error);
                });
            });
        });
    </script>
</div>

<div th:fragment="author(me)" class="author flex">
    <img class="margin-right" th:src="${me.pictureUrl}" th:alt="${me.fullName}" />
    <div>
        <a th:href="${me.slug}"><b th:text="${me.fullName}">Ray Sponsible</b></a>
        <div class="text-small bio" th:if="${me.biography}" th:text="${me.biography}">Biography</div>
        <div class="margin-top">
            <a target="_new"
               class="social-link facebook"
               wutsi-track-event="link"
               wutsi-track-value="facebook"
               th:if="${me.facebookUrl} AND !${me.facebookUrl.isEmpty()}"
               th:href="${me.facebookUrl}"
            >
                <i class="fab fa-facebook-f"></i>
            </a>
            <a target="_new"
               class="social-link twitter"
               wutsi-track-event="link"
               wutsi-track-value="twitter"
               th:if="${me.twitterUrl} AND !${me.twitterUrl.isEmpty()}"
               th:href="${me.twitterUrl}"
            >
                <i class="fab fa-twitter"></i>
            </a>
            <a target="_new"
               class="social-link linkedin"
               wutsi-track-event="link"
               wutsi-track-value="linkedin"
               th:if="${me.linkedInUrl} AND !${me.linkedInUrl.isEmpty()}"
               th:href="${me.linkedInUrl}"
            >
                <i class="fab fa-linkedin-in"></i>
            </a>
        </div>
    </div>
</div>

<section th:fragment="card(story)">
    <a th:href="${story.slug}">
        <h2 class="title" th:text="${story.title}">Title</h2>

        <div class="img-container margin-bottom" th:if="${story.thumbnailUrl} AND !${story.thumbnailUrl.isEmpty()}">
            <img class="border" th:async-src="${story.thumbnailUrl}" th:alt="${story.title}" />
        </div>

        <p class="summary" th:text="${story.summary}">Summary</p>

        <div class="meta flex">
            <div class="margin-right" th:text="${story.publishedDateTime}">12 May</div>
            <div>
                <span th:text="${story.readingMinutes}">2</span>
                <span th:text="#{label.minutes}">min</span>
            </div>
        </div>
    </a>
</section>


<div class="wizard" th:fragment="wizard(steps, current)">
    <ul class="step-indicator">
        <li th:classappend="${current} GE 1 ? active" th:if="${steps} GE 1"></li>
        <li th:classappend="${current} GE 2 ? active" th:if="${steps} GE 2"></li>
        <li th:classappend="${current} GE 3 ? active" th:if="${steps} GE 3"></li>
        <li th:classappend="${current} GE 4 ? active" th:if="${steps} GE 4"></li>
        <li th:classappend="${current} GE 5 ? active" th:if="${steps} GE 5"></li>
    </ul>
    <div class="clearfix"></div>
</div>

</body>
</html>
